# VGA 模式 03h 文本输出汇总（实模式）

本文系统性总结 **VGA 模式 03h（80×25 彩色文本模式）** 下的文本输出原理与常见用法，适用于 **8086 / DOS / emu8086 / Bootloader 实模式** 学习。

---

## 一、模式 03h 基本信息

| 项目         | 内容                    |
| ------------ | ----------------------- |
| 模式号       | `03h`                   |
| 类型         | 彩色文本模式            |
| 分辨率       | 80 列 × 25 行           |
| 每字符字节数 | 2 字节                  |
| 显存段地址   | `B800h`                 |
| 总显存大小   | 80 × 25 × 2 = 4000 字节 |

---

## 二、显存布局（B800:0000h）

在模式 03h 下，每个字符单元占 **2 字节**：

```text
低地址 → 高地址
+------------+------------+
| ASCII 字符 | 属性字节   |
+------------+------------+
```

### 示例

```asm
mov es:[di], 'A'     ; 字符
mov es:[di+1], 07h   ; 白字黑底
```

---

## 三、字符属性字节说明

属性字节结构（8 位）：

```text
7   6 5 4   3 2 1 0
BL  BG色     FG色
```

| 位  | 含义                                |
| --- | ----------------------------------- |
| 0–2 | 前景色（文字颜色）                  |
| 3   | 前景色高亮                          |
| 4–6 | 背景色                              |
| 7   | 闪烁（或高背景色，取决于 VGA 设置） |

### 常见颜色值

| 属性值 | 效果             |
| ------ | ---------------- |
| `07h`  | 白字黑底（默认） |
| `0Fh`  | 亮白字黑底       |
| `1Eh`  | 黄字蓝底         |
| `4Fh`  | 亮白字红底       |

---

## 四、行列到显存偏移的计算

### 公式

```text
offset = (row * 80 + col) * 2
```

| 参数      | 范围 |
| --------- | ---- |
| row（行） | 0–24 |
| col（列） | 0–79 |

### 示例

第 5 行，第 10 列：

```text
offset = (5 * 80 + 10) * 2 = 820
```

---

## 五、直接写显存输出字符（putc 思想）

### 基本步骤

1. 设置显存段：`ES = B800h`
2. 计算字符偏移
3. 写入字符和属性字节

### 示例代码

```asm
mov ax, 0B800h
mov es, ax

mov di, offset
mov es:[di], al      ; 字符
mov es:[di+1], ah    ; 属性
```

---

## 六、使用 BIOS 中断输出（对比）

### INT 10h / AH=0Eh（TTY 输出）

```asm
mov ah, 0Eh
mov al, 'A'
mov bh, 0
mov bl, 07h
int 10h
```

| 方式       | 优点               | 缺点                 |
| ---------- | ------------------ | -------------------- |
| BIOS 中断  | 自动处理光标、滚屏 | 慢、依赖 BIOS        |
| 直接写显存 | 快、可控           | 需自己处理行列、滚屏 |

---

## 七、光标与滚屏（概念）

- **光标位置**：BIOS 内部维护（行、列）
- 直接写显存 **不会自动移动光标**
- 滚屏需要手动：

  - 上移 24 行内容
  - 最后一行清空

---

## 八、典型应用场景

- DOS 程序直接文本输出
- Bootloader 显示提示信息
- 操作系统内核早期调试输出
- emu8086 汇编学习与实验

---

## 九、学习建议

1. 先理解 **显存布局 + 行列计算**
2. 再实现 `putc → puts`
3. 最后尝试滚屏和光标模拟

---

> 本文档适用于：8086 实模式、VGA 文本显示、emu8086 汇编实验、操作系统入门。
